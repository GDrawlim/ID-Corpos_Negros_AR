<script type="module">
import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.169.0/build/three.module.js';
import { ARButton } from 'https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/webxr/ARButton.js';

const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera();
const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
renderer.xr.enabled = true;
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);
document.body.appendChild(ARButton.createButton(renderer, { requiredFeatures: ['hit-test'] }));

const video = document.createElement('video');
video.src = /iPhone|iPad|iPod/i.test(navigator.userAgent) ? './video_transparente.mov' : './video_transparente.webm';
video.loop = true;
video.muted = true;
video.playsInline = true;

const texture = new THREE.VideoTexture(video);
const material = new THREE.MeshBasicMaterial({ map: texture, transparent: true });
const geometry = new THREE.PlaneGeometry(1, 1.78);
const mesh = new THREE.Mesh(geometry, material);
mesh.position.set(0, 0, -1.5);
scene.add(mesh);

renderer.xr.addEventListener('sessionstart', () => video.play());

renderer.setAnimationLoop(() => {
  renderer.render(scene, camera);
});
</script>
